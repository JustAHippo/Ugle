<html>
    <head>
        <title>Ugle! - </title>
        <style>
            ul {
                list-style-type: none;
                margin: 0;
                padding: 0;
            }
            p {
                font-size: 20px;
            }

        </style>
    </head>
    <body>

    <table cellpadding="0" cellspacing="0" width="100%">
        <tbody>
        <tr>
            <td valign="top">
                <a href="/">
                    <img src="/img/ugle.png" alt="Ugle" border="0" height="78" data-atf="1" data-frt="0">
                </a>
            </td>
            <td width="5">&nbsp;</td>
            <td align="left">
                <font face="verdana,arial,sans-serif">
                    <br>
                    <input id="searchBar" maxlength="50" name="q" size="31" type="text" value="ugle">
                    <select name="num">
                        <option selected="" value="10">10 results</option>
                        <option value="30">30 results</option>
                        <option value="100">100 results</option>
                    </select>
                    <nobr>&nbsp; <input name="sa" type="submit" value="Ugle Search" onclick="searchThing()">&nbsp; <input name="btnI" type="submit" value="I'm feeling lucky">
                    </nobr>
                </font>
            </td>
            <td align="right" valign="top">
                <a href="/help.html">
                    <font face="verdana,arial,sans-serif">Help</font>
                </a>
            </td>
        </tr>
        </tbody>
    </table>
    <hr size="1">
    <center><font color="#6f6f6f" size="-1" style="font-size: medium;">Showing results <b id="resultsCount"></b> of approximately <b id="resultsCount2"></b> for <b id="searchTerm"></b>. Search took <b>0.06</b> seconds.<br></font><br></center>
    <div id="searchResults"></div>

    <script>
        function searchThing() {
            let query = document.getElementById("searchBar").value
            location.href = "/search?q="+query
        }
        async function getResults(queryParam) {
            const response = await fetch("/api/v1/search?q=" + queryParam);
            const results = await response.json();
            return results;
        }
        const urlParams = new URLSearchParams(window.location.search);
        const queryParam = urlParams.get('q');
        document.getElementsByTagName("title").innerText = "Ugle! - " + queryParam
        document.getElementById("searchBar").value = queryParam
        getResults(queryParam).then ((results) => {
            console.log(results)
            try {
                document.getElementById("resultsCount").innerText = "1-" + results.length;
                document.getElementById("resultsCount2").innerText = results.length;
            } catch (err) {
                document.getElementById("resultsCount").innerText = "0-0";
                document.getElementById("resultsCount2").innerText = "0";
            }

            document.getElementById('searchTerm').innerText = queryParam
            document.title = "Ugle! - " + queryParam
            for (let i = 0; i < results.length; i++) {
                let title = results[i].Title
                let description = results[i].Description
                let domain = results[i].Domain
                let ip = results[i].IP
                if (title == "") { title = domain}
                if (description == "") { description = ip}
                elem = document.createElement("p")
                elem.innerHTML = "<a href=\" " + "http://"+ domain + "\">" + title + "/</a><font size=\"-1\"><br>" + description+ "</font></br><font color=\"#008000\" size=\"-1\">" + domain +" </font>";
                document.getElementById("searchResults").appendChild(elem);
            }

        });


    </script>
    <hr size="1">
    <center><font size="-1">Copyright Â©2023 Ugle Inc. -&nbsp;<a href="/about/">About</a> -&nbsp;<a href="">Help</a></font></center>
    </body>
</html>


